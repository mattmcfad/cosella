function formatTime(ms){return ms/1e3}var case0={test:function(first,second){return first.solved===!0||second.solved===!0?!1:first.id===second.id?!0:!1}},case1={test:function(first,second){var cell,cordX=first.x,cordY=first.y,solved=!1;if(first.x===second.x){if(first.y<second.y)for(;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y){solved=!0;break}if(cell.data().solved===!1){solved=!1;break}}if(first.y>second.y)for(;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y){solved=!0;break}if(cell.data().solved===!1){solved=!1;break}}}else if(first.y===second.y)if(first.x<second.x)for(;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x){solved=!0;break}if(cell.data().solved===!1){solved=!1;break}}else if(first.x>second.x)for(;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x){solved=!0;break}if(cell.data().solved===!1){solved=!1;break}}return solved===!0?(app.matchSuccess(first,second),!0):!1}},case2={test:function(first,second){function init(){cordX=first.x,cordY=first.y,solved=!1}var tempX,tempY,cell,cordX=first.x,cordY=first.y,solved=!1;if(first.x<second.x){if(!solved)for(init();cordY>1&&solved!==!0&&(cordY--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}if(!solved)for(init();12>cordY&&solved!==!0&&(cordY++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}}if(first.y>second.y){if(!solved)for(init();12>cordX&&solved!==!0&&(cordX++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}if(!solved)for(init();cordX>1&&solved!==!0&&(cordX--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}}if(first.x>second.x){if(!solved)for(init();cordY>1&&solved!==!0&&(cordY--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}if(!solved)for(init();12>cordY&&solved!==!0&&(cordY++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}}if(first.y<second.y){if(!solved)for(init();12>cordX&&solved!==!0&&(cordX++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}if(!solved)for(init();cordX>1&&solved!==!0&&(cordX--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}}return solved?(app.matchSuccess(first,second),!0):!1}},case3={test:function(first,second){function init(){cordX=first.x,cordY=first.y,solved=!1}var tempX,tempY,cell,cordX=first.x,cordY=first.y,solved=!1;if(first.x<second.x){if(!solved)for(init();cordX<second.x&&!solved&&(cordX++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}if(!solved)for(init();cordX<second.x&&!solved&&(cordX++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}}if(first.y>second.y){if(!solved)for(init();cordY>second.y&&!solved&&(cordY--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}if(!solved)for(init();cordY>second.y&&!solved&&(cordY--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}}if(first.x>second.x){if(!solved)for(init();cordX>second.x&&!solved&&(cordX--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY>second.y;){if(cordY--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}if(!solved)for(init();cordX>second.x&&!solved&&(cordX--,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordY===second.y){for(tempX=cordX;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordX=tempX}}cordY=first.y}}if(first.y<second.y){if(!solved)for(init();cordY<second.y&&!solved&&(cordY++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX<second.x;){if(cordX++,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}if(!solved)for(init();cordY<second.y&&!solved&&(cordY++,cell=$("#"+app.getId(cordX,cordY)),cell.data().solved===!0||void 0===cell.data().solved);){for(;cordX>second.x;){if(cordX--,cell=$("#"+app.getId(cordX,cordY)),cordY===second.y&&cordX===second.x){solved=!0;break}if(cell.data().solved!==!0&&void 0!==cell.data().solved)break;if(cordX===second.x){for(tempY=cordY;cordY<second.y;){if(cordY++,cell=$("#"+app.getId(cordX,cordY)),cordX===second.x&&cordY===second.y){solved=!0;break}if(cell.data().solved===!1)break}cordY=tempY}}cordX=first.x}}return solved?(app.matchSuccess(first,second),!0):!1}},firebase={init:function(){firebase.db=new Firebase("https://cosella.firebaseio.com/highscores"),firebase.localDB=Array(),firebase.db.on("child_added",function(snapshot){var obj=snapshot.val();firebase.localDB.push(obj)})},push:function(name,twitterHandle,level,score){firebase.db.push({name:name,twitter:twitterHandle,level:level,score:score})},parseScore:function(score,level){$("#usrlvl").text(level),$("#usrpoints").text(score);var obj={name:"You!",twitter:"@yourTwitterHandle",level:level,score:score};firebase.localDB.push(obj),$("#usrRank").text(firebase.getRank())},getRank:function(){firebase.sortDB();for(var i=0;i<firebase.localDB.length;i++)if("You!"===firebase.localDB[i].name)return i+1;return"99"},sortDB:function(){firebase.localDB.sort(function(a,b){return b.score-a.score})},getHighscores:function(){var selector=$("ol");selector.html("");for(var i=0;5>i;i++){var twitterHandle=firebase.localDB[i].twitter;"@"!==twitterHandle.charAt(0)&&(twitterHandle="@"+twitterHandle);var twitterUrl="https://twitter.com/"+twitterHandle;selector.append("<li class='scoreListItem'><div class='middle'><div class='top'>"+firebase.localDB[i].name+"<span class='usrlvl'> Level</span></div><div class='bottom'><a href='"+twitterUrl+"'target='_blank'>"+twitterHandle+"</a><span class='usrlvl'>"+firebase.localDB[i].level+"</span></div></div> <p class='right'>"+firebase.localDB[i].score+"</p></li>")}}},icons=[{id:0,color:"darkblue",img:"Qbert"},{id:1,color:"saddlebrown",img:"Hami"},{id:2,color:"gold",img:"Chris"},{id:3,color:"gray",img:"Rob"},{id:4,color:"mediumaquamarine",img:"Simon"},{id:5,color:"darkkhaki",img:"Owen"},{id:6,color:"brown",img:"Mark-L"},{id:7,color:"peru",img:"Steven"},{id:8,color:"deeppink",img:"Brian"},{id:9,color:"cyan",img:"Raymond"},{id:10,color:"lightcoral",img:"Hannah"},{id:11,color:"steelblue",img:"Adam"},{id:12,color:"darkviolet",img:"Jenn"},{id:13,color:"limegreen",img:"Rebecca"},{id:14,color:"whitesmoke",img:"Hema"}],app={init:function(){app.timeLimit=1e5,app.count=app.timeLimit,$("#countdown").html(formatTime(app.count)),timer.set({time:10,autostart:!1}),app.score=0,$(".totscore").html(app.score),app.gamePaused=!1,app.totCells=144,app.currentLevel=1;var gamegrid=$("#gamegrid");app.moreTime=3,$("#addMoreTime").text(app.moreTime),app.reOrders=2,$("#addReOrder").text(app.reOrders);for(var cellStart='<div class=cell data-id="null" style="background-color: rgba(237,236,236,1)" id=',cellNullStart='<div class=cell data-id="null" style="background-color: transparent" id=',cellEnd="></div>",cellHTML="",i=1;i<app.totCells+1;i++)cellHTML=1===app.getX(i)||12===app.getX(i)||1===app.getY(i)||12===app.getY(i)?cellNullStart+i+cellEnd:cellStart+i+cellEnd,gamegrid.append(cellHTML),cellHTML=cellStart;app.octocatTracker=Array(),app.buildIcons(app.currentLevel)},eventListeners:function(){function closeModal(){app.gamePaused===!0&&timer.play(),$(".overlay").fadeOut()}var select=!1;$(".cell").on("click",function(event){event.preventDefault();var selectedCell=$(this),selectedCellData=selectedCell.data();null!==selectedCellData.id&&(timer.isActive||timer.play(!0),select===!1?(select=!0,selectedCell.addClass("selected"),app.first=selectedCellData):app.getId(selectedCellData.x,selectedCellData.y)===app.getId(app.first.x,app.first.y)?(selectedCell.removeClass("selected"),select=!1):(select=!1,app.second=selectedCellData,app.checkMatch()))}),$(".overlay").on("click",function(){$(this).hasClass("close")&&closeModal()}),$("#nextLvl").on("click",function(){$("#nextLevel").fadeOut(),app.buildIcons(app.currentLevel)}),$(".playAgain").on("click",function(){app.restartGame()}),$("#highScores").on("click",function(){app.highScores()}),$("#submitScore").on("click",function(){var twitter=$("#inputTwitter").val(),name=$("#inputName").val();""===name?app.displayMessage("error"):(""===twitter&&(twitter="@mattmcfad"),app.submitScore(name,twitter))}),$("#moreTime").on("click",function(){0!==app.moreTime&&app.addMoreTime()}),$("#instruct").on("click",function(){app.instructions()}),$("#reOrder").on("click",function(){0!==app.reOrders&&(app.reOrder(app.rows,app.columns,app.start),app.reOrders--,$("#addReOrder").text(app.reOrders))})},buildIcons:function(level){function init(level){distribution=new Array(icons.length);for(var k=0;k<icons.length;k++)distribution[k]=0;switch(level>4&&(level=4),level){case 1:start=40,rows=6,columns=6;break;case 2:start=27,rows=8,columns=8;break;case 3:start=26,rows=8,columns=10;break;case 4:start=14,rows=10,columns=10}totalOutput=rows*columns,app.totIcons=totalOutput,totDistributed=0,selector="#",app.start=start,app.rows=rows,app.columns=columns}app.totSolved=0;var distribution,totDistributed,totalOutput,rows,columns,icon,odd,start,selector,sum;init(level);for(var i=0;columns>i;i++)for(var j=0;rows>j;j++){sum=start+i+12*j;var sel=$(selector+sum);if(totalOutput-totDistributed<=icons.length){odd=!1;for(var k=0;k<distribution.length;k++)if(distribution[k]%2===1){icon=icons[k],odd=!0;break}odd===!1&&(icon=app.getIcon())}else icon=app.getIcon();distribution[icon.id]++,totDistributed++;var img="url(images/icons/"+icon.img+".png)";sel.css("background-image",img),sel.data("id",icon.img),sel.data("solved",!1),sel.data("x",app.getX(sum)),sel.data("y",app.getY(sum))}app.reOrder(rows,columns,start)},getIcon:function(){var rand=Math.floor(Math.random()*icons.length);return icons[rand]},getOctocat:function(){var rand=Math.floor(Math.random()*octocats.length);return app.octocatTracker.contains(rand)?app.getOctocat():(app.octocatTracker.push(rand),octocats[rand].img)},getX:function(id){return id%12===0?12:id%12},getY:function(id){return Math.ceil(id/12)},getId:function(x,y){return x+12*(y-1)},increaseScore:function(){app.score+=10,$(".totscore").html(app.score)},checkMatch:function(){$(".cell").removeClass("selected"),case0.test(app.first,app.second)===!0&&case1.test(app.first,app.second)===!1&&case2.test(app.first,app.second)===!1&&case3.test(app.first,app.second)},matchSuccess:function(first,second){cell1=$("#"+app.getId(first.x,first.y)),cell2=$("#"+app.getId(second.x,second.y)),"Qbert"===cell1.data("id")&&(app.moreTime++,$("#addMoreTime").text(app.moreTime)),cell1.data("solved",!0),cell1.data("id",null),cell2.data("solved",!0),cell2.data("id",null),cell1.css("background-color","rgba(237,236,236,1)"),cell2.css("background-color","rgba(237,236,236,1)"),cell1.css("background-image","none"),cell2.css("background-image","none"),app.totSolved=app.totSolved+2,app.increaseScore(),app.testLevelCompletion()},testLevelCompletion:function(){if(app.totSolved===app.totIcons){timer.stop(),$("#countdown").removeClass("lowTime");var bonusPoints=parseInt(formatTime(app.count));app.score+=bonusPoints,app.currentLevel++;var timeReduced=0;app.currentLevel>4&&(timeReduced=10*(app.currentLevel-4)*1e3),app.reOrders=2,$("#addReOrder").text(app.reOrders),app.count=app.timeLimit-timeReduced,0===app.count&&(app.count=1e4),$("#countdown").html(formatTime(app.count)),app.nextLevel(bonusPoints)}},nextLevel:function(){$("#nextLevel").fadeIn(),$(".totscore").html(app.score);var image="images/octocats/"+app.getOctocat();$("#octocat").attr("src",image)},reOrder:function(rows,columns,start){function randomNumber(){var rand=Math.floor(Math.random()*iconsUsed.length);return iconsDistributed.contains(rand)?randomNumber(length):(iconsDistributed.push(rand),rand)}for(var sum,idsUsed=Array(),iconsUsed=Array(),iconsDistributed=Array(),selector="#",i=0;columns>i;i++)for(var j=0;rows>j;j++){sum=start+i+12*j;var sel=$(selector+sum);null!==sel.data().id&&(idsUsed.push(sum),iconsUsed.push(sel.data().id))}for(var k=0;k<idsUsed.length;k++){var select=$(selector+idsUsed[k]),icon=randomNumber();select.data("id",iconsUsed[icon]);var img="url(images/icons/"+iconsUsed[icon]+".png)";select.css("background-image",img)}},addMoreTime:function(){app.moreTime--,$("#addMoreTime").text(app.moreTime),app.count=app.count+1e4},instructions:function(){app.gamePaused=!0,timer.pause(),$("#instructions").fadeIn()},gameOver:function(){$("#timesUp").fadeIn(),$("#gameOverOcto").attr("src","images/octocats/gameover.png")},restartGame:function(){$("#gamegrid").html(""),timer.pause(),app.init(),firebase.init(),app.eventListeners(),$("#highScore").fadeOut(),$("#timesUp").fadeOut(),$("input").val("")},highScores:function(){$("#highScore").fadeIn(),firebase.parseScore(app.score,app.currentLevel),firebase.getHighscores(),$("#timesUp").hide(),$("#submitScore").show()},submitScore:function(name,twitterHandle){firebase.push(name,twitterHandle,app.currentLevel,app.score),$("#submitScore").fadeOut(),app.displayMessage("submit")},displayMessage:function(msg){$("#"+msg).show(),setTimeout(function(){$("#"+msg).fadeOut()},1500)}};$(document).ready(function(){app.init(),firebase.init(),app.eventListeners()}),Array.prototype.contains=function(needle){for(var i in this)if(this[i]==needle)return!0;return!1};var octocats=[{img:"bear-cavalry.png"},{img:"daftpunktocat-guy.gif"},{img:"heisencat.png"},{img:"homercat.png"},{img:"ironcat.jpg"},{img:"murakamicat.png"},{img:"nyantocat.gif"},{img:"octobiwan.jpg"},{img:"spidertocat.png"},{img:"steroidtocat.png"},{img:"topguntocat.png"},{img:"visionary.jpg"},{img:"xtocat.jpg"},{img:"riddlocat.png"},{img:"stormtroopocat.png"},{img:"okal-eltocat.jpg"},{img:"dodgetocat_v2.png"},{img:"daftpunktocat-thomas.gif"}],timer=$.timer(function(){$("#countdown").html(formatTime(app.count)),0===app.count&&(timer.stop(),app.gameOver()),app.count-=10,app.count>1e4?$("#countdown").removeClass("lowTime"):$("#countdown").addClass("lowTime"),app.count<0&&(app.count=0)});